From 2b9949566db9d61cca461eb7f3463ef928de6039 Mon Sep 17 00:00:00 2001
From: aroflcoppter <contact@dankium.ca>
Date: Mon, 9 Jun 2025 03:22:13 -0230
Subject: [PATCH] adblock fix build on windows

Copyright (C) 2006-present eyeo GmbH.

---
 .../eyeo_filtering_private_api.cc             | 47 -------------------
 .../x64/elevation_service_idl.h               |  2 +-
 .../x64/elevation_service_idl_i.c             |  2 +-
 .../x64/elevation_service_idl_p.c             |  2 +-
 .../x64/tracing_service_idl.h                 |  2 +-
 .../x64/tracing_service_idl_i.c               |  2 +-
 .../x64/tracing_service_idl_p.c               |  2 +-
 .../iaccessible2/x64/ia2_api_all.h            |  2 +-
 .../iaccessible2/x64/ia2_api_all_i.c          |  2 +-
 .../iaccessible2/x64/ia2_api_all_p.c          |  2 +-
 .../x64/ISimpleDOMDocument.h                  |  2 +-
 .../x64/ISimpleDOMDocument_i.c                |  2 +-
 .../x64/ISimpleDOMDocument_p.c                |  2 +-
 .../ISimpleDOMNode.idl/x64/ISimpleDOMNode.h   |  2 +-
 .../ISimpleDOMNode.idl/x64/ISimpleDOMNode_i.c |  2 +-
 .../ISimpleDOMNode.idl/x64/ISimpleDOMNode_p.c |  2 +-
 .../ISimpleDOMText.idl/x64/ISimpleDOMText.h   |  2 +-
 .../ISimpleDOMText.idl/x64/ISimpleDOMText_i.c |  2 +-
 .../ISimpleDOMText.idl/x64/ISimpleDOMText_p.c |  2 +-
 .../platform/x64/ichromeaccessible.h          |  2 +-
 .../platform/x64/ichromeaccessible_i.c        |  2 +-
 .../platform/x64/ichromeaccessible_p.c        |  2 +-
 22 files changed, 21 insertions(+), 68 deletions(-)

diff --git a/chrome/browser/extensions/api/eyeo_filtering_private/eyeo_filtering_private_api.cc b/chrome/browser/extensions/api/eyeo_filtering_private/eyeo_filtering_private_api.cc
index 533456160beec..8c53430020ecb 100644
--- a/chrome/browser/extensions/api/eyeo_filtering_private/eyeo_filtering_private_api.cc
+++ b/chrome/browser/extensions/api/eyeo_filtering_private/eyeo_filtering_private_api.cc
@@ -42,9 +42,6 @@ namespace extensions {
 
 namespace {
 
-constexpr char kConfigurationMissing[] =
-    "Configuration with name '%s' does not exist!";
-
 adblock::FilteringConfiguration* FindFilteringConfiguration(
     content::BrowserContext* context,
     const std::string& config_name) {
@@ -568,10 +565,6 @@ EyeoFilteringPrivateSetEnabledFunction::Run() {
   EXTENSION_FUNCTION_VALIDATE(params);
   auto* configuration = FindFilteringConfiguration(
       GetOriginalBrowserContext(browser_context()), params->configuration);
-  if (!configuration) {
-    return RespondNow(Error(base::StringPrintf(kConfigurationMissing,
-                                               params->configuration.c_str())));
-  }
   configuration->SetEnabled(params->enabled);
   return RespondNow(NoArguments());
 }
@@ -588,10 +581,6 @@ ExtensionFunction::ResponseAction EyeoFilteringPrivateIsEnabledFunction::Run() {
   EXTENSION_FUNCTION_VALIDATE(params);
   auto* configuration = FindFilteringConfiguration(
       GetOriginalBrowserContext(browser_context()), params->configuration);
-  if (!configuration) {
-    return RespondNow(Error(base::StringPrintf(kConfigurationMissing,
-                                               params->configuration.c_str())));
-  }
   return RespondNow(
       ArgumentList(api::eyeo_filtering_private::IsEnabled::Results::Create(
           configuration->IsEnabled())));
@@ -623,10 +612,6 @@ EyeoFilteringPrivateAddFilterListFunction::Run() {
   EXTENSION_FUNCTION_VALIDATE(params);
   auto* configuration = FindFilteringConfiguration(
       GetOriginalBrowserContext(browser_context()), params->configuration);
-  if (!configuration) {
-    return RespondNow(Error(base::StringPrintf(kConfigurationMissing,
-                                               params->configuration.c_str())));
-  }
   auto url = GURL{params->url};
   auto status =
       RunSubscriptionAction(configuration, SubscriptionAction::kInstall, url);
@@ -650,10 +635,6 @@ EyeoFilteringPrivateRemoveFilterListFunction::Run() {
   EXTENSION_FUNCTION_VALIDATE(params);
   auto* configuration = FindFilteringConfiguration(
       GetOriginalBrowserContext(browser_context()), params->configuration);
-  if (!configuration) {
-    return RespondNow(Error(base::StringPrintf(kConfigurationMissing,
-                                               params->configuration.c_str())));
-  }
   auto url = GURL{params->url};
   auto status =
       RunSubscriptionAction(configuration, SubscriptionAction::kUninstall, url);
@@ -677,10 +658,6 @@ EyeoFilteringPrivateGetFilterListsFunction::Run() {
   EXTENSION_FUNCTION_VALIDATE(params);
   auto* configuration = FindFilteringConfiguration(
       GetOriginalBrowserContext(browser_context()), params->configuration);
-  if (!configuration) {
-    return RespondNow(Error(base::StringPrintf(kConfigurationMissing,
-                                               params->configuration.c_str())));
-  }
   auto* subscription_service =
       adblock::SubscriptionServiceFactory::GetForBrowserContext(
           GetOriginalBrowserContext(browser_context()));
@@ -703,10 +680,6 @@ EyeoFilteringPrivateAddAllowedDomainFunction::Run() {
   EXTENSION_FUNCTION_VALIDATE(params);
   auto* configuration = FindFilteringConfiguration(
       GetOriginalBrowserContext(browser_context()), params->configuration);
-  if (!configuration) {
-    return RespondNow(Error(base::StringPrintf(kConfigurationMissing,
-                                               params->configuration.c_str())));
-  }
   configuration->AddAllowedDomain(params->domain);
   return RespondNow(NoArguments());
 }
@@ -725,10 +698,6 @@ EyeoFilteringPrivateRemoveAllowedDomainFunction::Run() {
   EXTENSION_FUNCTION_VALIDATE(params);
   auto* configuration = FindFilteringConfiguration(
       GetOriginalBrowserContext(browser_context()), params->configuration);
-  if (!configuration) {
-    return RespondNow(Error(base::StringPrintf(kConfigurationMissing,
-                                               params->configuration.c_str())));
-  }
   configuration->RemoveAllowedDomain(params->domain);
   return RespondNow(NoArguments());
 }
@@ -746,10 +715,6 @@ EyeoFilteringPrivateGetAllowedDomainsFunction::Run() {
   EXTENSION_FUNCTION_VALIDATE(params);
   auto* configuration = FindFilteringConfiguration(
       GetOriginalBrowserContext(browser_context()), params->configuration);
-  if (!configuration) {
-    return RespondNow(Error(base::StringPrintf(kConfigurationMissing,
-                                               params->configuration.c_str())));
-  }
   return RespondNow(ArgumentList(
       api::eyeo_filtering_private::GetCustomFilters::Results::Create(
           configuration->GetAllowedDomains())));
@@ -768,10 +733,6 @@ EyeoFilteringPrivateAddCustomFilterFunction::Run() {
   EXTENSION_FUNCTION_VALIDATE(params);
   auto* configuration = FindFilteringConfiguration(
       GetOriginalBrowserContext(browser_context()), params->configuration);
-  if (!configuration) {
-    return RespondNow(Error(base::StringPrintf(kConfigurationMissing,
-                                               params->configuration.c_str())));
-  }
   configuration->AddCustomFilter(params->filter);
   return RespondNow(NoArguments());
 }
@@ -790,10 +751,6 @@ EyeoFilteringPrivateRemoveCustomFilterFunction::Run() {
   EXTENSION_FUNCTION_VALIDATE(params);
   auto* configuration = FindFilteringConfiguration(
       GetOriginalBrowserContext(browser_context()), params->configuration);
-  if (!configuration) {
-    return RespondNow(Error(base::StringPrintf(kConfigurationMissing,
-                                               params->configuration.c_str())));
-  }
   configuration->RemoveCustomFilter(params->filter);
   return RespondNow(NoArguments());
 }
@@ -805,10 +762,6 @@ EyeoFilteringPrivateGetCustomFiltersFunction::Run() {
   EXTENSION_FUNCTION_VALIDATE(params);
   auto* configuration = FindFilteringConfiguration(
       GetOriginalBrowserContext(browser_context()), params->configuration);
-  if (!configuration) {
-    return RespondNow(Error(base::StringPrintf(kConfigurationMissing,
-                                               params->configuration.c_str())));
-  }
   return RespondNow(ArgumentList(
       api::eyeo_filtering_private::GetCustomFilters::Results::Create(
           configuration->GetCustomFilters())));
-- 
2.49.0.windows.1

